import{d as U,r as B,u as O,a as T,b as f,c as z,o as x,e as I,f as G,g as P,s as H,h as a,i as S,j as F,k as e,w as o,l as y,m as _,t as i,n as A,p as D,F as M,q as Y,v as L,x as q,y as r,_ as N,z as j,A as J}from"./index.66cc4c36.js";import{_ as K,S as Q,A as W,a as X}from"./announce.89061fc5.js";import{V as Z,C as ee}from"./vars.a08ea0cc.js";import{C as oe}from"./common.b6c75224.js";import{R as te}from"./registerForm.0724201b.js";import{E as se}from"./index.187d93a7.js";import"./user.f1b2b1fb.js";const R=c=>(L("data-v-71f1bbad"),c=c(),q(),c),ne=R(()=>r("img",{src:K,width:"350"},null,-1)),ae=R(()=>r("br",null,null,-1)),le=R(()=>r("span",{class:"fff"},"LDAP",-1)),re=U({__name:"login-form",setup(c){const n=B({username:"",password:"",is_ldap:!1,is_oidc:!1,is_mfa:!1}),p=O(),h=T(),b=f(!1),u=f(""),k=z(()=>h.query).value,l=async()=>{const{data:t}=await Y();t.code==1200&&t.payload.enabled&&t.payload.authUrl&&(b.value=!0,u.value=t.payload.authUrl)};x(()=>{if(l(),k.oidcLogin){const{oidcLogin:t,...s}=k;p.commit("user/USER_STORE",s),p.commit("menu/CHANGE_SELECTED",["/home"]),I.replace("/home")}});const d=()=>{window.location.href=u.value};G();const w=P(async()=>{const{data:t}=await H(n);if(t.code!==1301){if(t.payload.is_mfa){I.push({name:"mfa",query:{username:n.username,password:n.password}});return}p.commit("user/USER_STORE",t.payload),p.commit("menu/CHANGE_SELECTED",["/home"]),I.replace("/home")}},200);return(t,s)=>{const C=a("a-input"),g=a("a-form-item"),$=a("a-checkbox"),E=a("a-space"),m=a("a-button"),V=a("a-form");return S(),F(M,null,[ne,ae,e(V,{model:n},{default:o(()=>[e(g,null,{default:o(()=>[e(C,{value:n.username,"onUpdate:value":s[0]||(s[0]=v=>n.username=v),placeholder:t.$t("user.username"),style:{"border-radius":"10px"}},null,8,["value","placeholder"])]),_:1}),e(g,null,{default:o(()=>[e(C,{value:n.password,"onUpdate:value":s[1]||(s[1]=v=>n.password=v),placeholder:t.$t("user.password"),style:{"border-radius":"10px"},type:"password",onPressEnter:s[2]||(s[2]=()=>y(w)())},null,8,["value","placeholder"])]),_:1}),e(g,null,{default:o(()=>[e(E,{size:50},{default:o(()=>[e($,{checked:n.is_ldap,"onUpdate:checked":s[3]||(s[3]=v=>n.is_ldap=v)},{default:o(()=>[le]),_:1},8,["checked"])]),_:1})]),_:1}),e(m,{type:"dashed",block:"",ghost:"",onClick:y(w)},{default:o(()=>[_(i(t.$t("common.signin")),1)]),_:1},8,["onClick"]),b.value?(S(),A(m,{key:0,type:"dashed",block:"",ghost:"",style:{"margin-top":"10px"},onClick:d},{default:o(()=>[_("OIDC "+i(t.$t("common.signin")),1)]),_:1})):D("v-if",!0)]),_:1},8,["model"])],64)}}});const ie=N(re,[["__scopeId","data-v-71f1bbad"],["__file","F:/inf/Yearning/gemini-next/src/views/login/login-form.vue"]]),ce=c=>(L("data-v-4ca33632"),c=c(),q(),c),_e={style:{"margin-left":"2%"}},ue={class:"fff"},de=ce(()=>r("video",{id:"v1",autoplay:"",loop:"",muted:""},[r("source",{src:X,type:"video/mp4"})],-1)),pe={class:"login_container"},me={class:"footer"},fe={style:{"text-align":"center"}},ge={style:{"text-align":"center"}},ve=U({__name:"login",setup(c){const n=f(!1),p=f(),h=f(),b=f(),{is_open:u}=oe(),k=()=>{p.value.open()};return x(async()=>{const{data:l}=await j();n.value=l.payload.reg,se.on("closeState",()=>{u.value=!1})}),(l,d)=>{const w=a("a-button"),t=a("a-space"),s=a("a-typography-link"),C=a("a-tooltip"),g=a("a-col"),$=a("a-row"),E=a("a-modal");return S(),F("div",null,[r("div",_e,[e(t,null,{default:o(()=>[r("span",ue,i(y(Z)),1),n.value?(S(),A(w,{key:0,type:"dashed",ghost:"",size:"small",onClick:d[0]||(d[0]=m=>u.value=!0)},{default:o(()=>[_(i(l.$t("user.form.title")),1)]),_:1})):D("v-if",!0)]),_:1})]),de,r("div",pe,[e(ie)]),r("div",me,[e($,null,{default:o(()=>[e(g,{span:24},{default:o(()=>[r("div",fe,[e(t,{size:"large"},{default:o(()=>[e(s,{href:"https://yearning.io",target:"_blank",style:{color:"#ffffff"}},{default:o(()=>[_(i(l.$t("common.about")),1)]),_:1}),e(C,null,{title:o(()=>[_(i(l.$t("common.qq")),1)]),default:o(()=>[_(" "+i(l.$t("common.community")),1)]),_:1}),e(s,{style:{color:"#ffffff"},onClick:k},{default:o(()=>[_(i(l.$t("common.sponsor")),1)]),_:1}),e(s,{style:{color:"#ffffff"},onClick:d[1]||(d[1]=m=>h.value.open())},{default:o(()=>[_(i(l.$t("common.statement")),1)]),_:1}),e(s,{href:"https://www.gnu.org/licenses/agpl-3.0.en.html",target:"_blank",style:{color:"#ffffff"}},{default:o(()=>[_("AGPL3.0")]),_:1}),r("div",ge,i(y(ee)),1)]),_:1})])]),_:1})]),_:1})]),e(Q,{ref_key:"sponsor",ref:p},null,512),e(W,{ref_key:"announce",ref:h},null,512),e(E,{visible:y(u),"onUpdate:visible":d[2]||(d[2]=m=>J(u)?u.value=m:null),title:l.$t("user.form.title")},{footer:o(()=>[]),default:o(()=>[e(te,{ref_key:"register",ref:b},null,512)]),_:1},8,["visible","title"])])}}});const $e=N(ve,[["__scopeId","data-v-4ca33632"],["__file","F:/inf/Yearning/gemini-next/src/views/login/login.vue"]]);export{$e as default};
